# HN-Insight 项目架构文档 (V0.2)

> **版本**: V0.2 (Visual Dashboard Refactor)
> **日期**: 2026-01-14
> **作者**: Antepil (AI Assistant)

## 1. 项目简介 (Introduction)

**HN-Insight** 是一个现代化的 Hacker News 阅读器，旨在通过高密度的“情报仪表盘”UI 和 AI 辅助功能（摘要、情感分析、评论提取），提升开发者获取技术资讯的效率。V0.2 版本重点重构了视觉展现层，实现了卡片式仪表盘布局。

## 2. 技术栈 (Tech Stack)

### 核心框架
- **Framework**: [Next.js 16](https://nextjs.org/) (App Router)
- **Language**: TypeScript
- **Runtime**: Node.js

### 样式与 UI
- **Styling Engine**: [Tailwind CSS v4](https://tailwindcss.com/)
- **Component Library**: [Shadcn UI](https://ui.shadcn.com/) (Radix UI based)
- **Icons**: Lucide React
- **Animation**: CSS Grid & Transitions

### 数据与状态
- **Data Fetching**: SWR (Stale-While-Revalidate)
- **State Management**: React Context (for Language Integration)
- **Translation**: `google-translate-api-x` (Backend Proxy)

## 3. 核心目录结构 (Directory Structure)

```
src/
├── app/                        # Next.js App Router 路由
│   ├── api/stories/route.ts    # [后端] 故事聚合与翻译 API
│   ├── layout.tsx              # [前端] 全局布局 (Fonts, Providers)
│   ├── page.tsx                # [前端] 首页入口
│   └── globals.css             # [样式] 全局样式 & Tailwind 配置
│
├── components/                 # React 组件
│   ├── ui/                     # [Shadcn] 基础 UI 组件 (Badge, Card, Tabs...)
│   ├── story-card.tsx          # [核心] Insight Card 业务组件
│   ├── story-list.tsx          # [核心] 列表容器与各种状态处理
│   └── language-switcher.tsx   # [功能] 语言切换悬浮按钮
│
├── lib/                        # 工具库
│   ├── contexts/               # React Context (LanguageContext)
│   ├── hn-api.ts               # 前端 API 调用封装
│   ├── mock-data.ts            # V0.2 测试用高保真模拟数据
│   └── types.ts                # TypeScript 类型定义 (Story, HnItem)
```

## 4. 关键设计规范 (Key Design Specifications)

### 4.1 视觉布局 (Visual Layout)
- **Grid System**: 采用 CSS Grid 布局，严格的 1 行 3 列 (Desktop) 设计。
    - Desktop (`lg`): 3 Columns
    - Tablet (`md`): 2 Columns
    - Mobile: 1 Column
- **Container**: 最大宽度限制为 `1280px`，居中显示。
- **Card Sizing**: 
    - 强制固定高度 `380px`，确保视觉对齐。
    - 内容溢出处理：标题限制 2 行 (`line-clamp-2`)，Tab 内容区域内部滚动。

### 4.2 卡片组件 (Insight Card)
V0.2 的核心单元，包含以下分层结构：
1.  **Header**: 
    - 标题 (支持中英切换)
    - 元数据行 (时间/分数/评论数/来源域名)
    - 分类 Badge (如 "编程开发", "AI")
2.  **Sentiment Bar**: 
    - 可视化情感条 (Construction/Technical/Controversial)。
    - V0.2 版本在无真实 AI 数据时显示默认中立状态。
3.  **Content Tabs**:
    - **Summary**: 技术摘要
    - **Interpretation**: 通俗解读
    - **Comments**: 核心评论
    - *交互*：点击 Tab 切换内容面板，支持独立滚动。
4.  **Footer**:
    - 关键词 Tags (截断显示前 2 个)。

### 4.3 国际化 (Localization)
- **策略**: 混合模式。
- **静态文本**: 使用 `LanguageContext` + 字典映射 (React Client Side)。
- **动态内容**: 
    - 标题：由后端 API 预翻译 (`titleZh`)。
    - 摘要/评论：未来对接 AI 翻译 API。
- **无闪烁体验**: 优先展示中文 (如果 Available)，切换瞬间无布局跳动。

### 4.4 数据流 (Data Flow)
1.  **Client**: `StoryList` 使用 `useSWR` 发起请求。
2.  **Next.js API Route (`/api/stories`)**:
    - 获取 Hacker News TopStories IDs。
    - 并行获取 Item Details。
    - **并行翻译** 标题 (Google Translate)。
    - 过滤无效/死链数据。
    - 返回聚合后的 JSON 给前端。

---
*Document Generated by Antepil Agent.*
